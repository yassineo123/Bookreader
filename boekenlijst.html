<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Bibliotheek - Home</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- Navbar -->
    <header class="navbar">
        <div class="container navbar-content">
            <a href="index.html" class="logo-link">
                <i data-lucide="library" class="logo-icon"></i>
                <h1>Open Bibliotheek</h1>
            </a>
            <nav class="nav-menu">
                <a href="mijn-boekenplank.html" class="nav-button">
                    Mijn Boekenplank
                </a>
            </nav>
        </div>
    </header>
        <!-- Hero Section -->
    <section class="hero">
        <div class="hero-overlay">
            <img src="https://images.unsplash.com/photo-1662582631700-676a217d511f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxsaWJyYXJ5JTIwYm9va3MlMjBzaGVsdmVzfGVufDF8fHx8MTc2MjUwNjU3MHww&ixlib=rb-4.1.0&q=80&w=1080" alt="Library background" class="hero-bg">
        </div>
        <div class="hero-content container">
            <h2 class="hero-title">boekenlijst</h2>
            <p class="hero-subtitle">
                ontdek alle boeken die wij aanbieden.
            </p>
        </div> 
    </section>
    <!-- Grid -->
    <section>
        <div class="container">
            <div id="all-books-grid" class="books-grid"></div>

            <!-- Loading -->
            <div id="all-books-loading" class="search-loading" style="display:none;">
                <div class="loading-spinner"></div>
                <p>Boeken laden…</p>
            </div>

            <!-- Error -->
            <div id="all-books-error" class="search-error" style="display:none;">
                <p>Kon de boeken niet laden. Probeer opnieuw.</p>
            </div>

            <!-- Meer laden knop -->
            <div style="text-align:center; margin-top: 30px;">
                <button id="load-more-books" class="view-all-button">
                    Meer boeken laden
                </button>
            </div>
        </div>
    </section>




    <!-- Script -->
    <script src="script.js"></script>

    <script>
    // ============================
    //  BOEKENLIJST PAGINATION PAGE
    // ============================

    let nextPageUrl = "https://gutendex.com/books/?page=1";

    async function loadBooks() {
        const grid = document.getElementById("all-books-grid");
        const loader = document.getElementById("all-books-loading");
        const error = document.getElementById("all-books-error");

        loader.style.display = "block";
        error.style.display = "none";

        try {
            const response = await fetch(nextPageUrl);
            const data = await response.json();

            nextPageUrl = data.next; // volgende pagina

            const books = data.results.map(convertBookData);

            // Voeg boeken toe aan grid
            grid.innerHTML += books.map(book => createBookCard(book, true)).join('');

            // Event listeners koppelen (boek-detail, buttons)
            grid.querySelectorAll('.book-card-trending').forEach(card => {
                const bookId = card.dataset.bookId;
                const book = books.find(b => b.id === bookId);

                card.addEventListener('click', (e) => {
                    if (!e.target.closest('.book-action-btn')) {
                        saveBookData(book);
                        window.location.href = `boek-detail.html?id=${bookId}`;
                    }
                });

                card.querySelectorAll('.book-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const action = btn.dataset.action;
                        handleBookAction(book, action, btn);
                    });
                });
            });

            loader.style.display = "none";

            // Verberg de knop als er geen volgende pagina is
            if (!data.next) {
                document.getElementById("load-more-books").style.display = "none";
            }

        } catch (err) {
            loader.style.display = "none";
            error.style.display = "block";
        }
    }

    // Eerste load
    loadBooks();

    // Meer laden knop
    document.getElementById("load-more-books").addEventListener("click", loadBooks);

    </script>

        <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>© 2025 Open Bibliotheek.</p>
        </div>
    </footer>
</body>
</html>